<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Implementation of heatmaps that offers more control
    over dimensions and appearance.">
<title>Pretty Heatmaps • pheatmap</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="deps/JetBrains_Mono-0.4.2/font.css" rel="stylesheet">
<link href="deps/Jost-0.4.2/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Pretty Heatmaps">
<meta property="og:description" content="Implementation of heatmaps that offers more control
    over dimensions and appearance.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">pheatmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.12</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/example_analysis.html">Example analysis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="pheatmap">pheatmap<a class="anchor" aria-label="anchor" href="#pheatmap"></a>
</h1></div>
<p>Package author: Raivo Kolde</p>
<p>Website author: Caroline Wensel</p>
<p>Goal/ description: A package for drawing pretty heatmaps in R. The ordinary heatmap function in R has several drawbacks when it comes to producing publication quality heatmaps. It is hard to produce pictures with consistent text, cell and overall sizes and shapes. The function pheatmap tries to alleviate the problems by offering more fine grained control over heatmap dimensions and appearance.</p>
<p>Website customization</p>
<ol style="list-style-type: decimal">
<li>theme: litera</li>
<li>heading, and code fonts</li>
<li>link and hover color in the navbar and sidebar</li>
<li>syntax highlighting in code blocks</li>
<li>navbar background color</li>
</ol>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the CRAN version use just</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>install.packages<span class="op">(</span>pheatmap<span class="op">)</span></span></code></pre></div>
<p>You can install the development version using <code>devtools</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>library<span class="op">(</span>devtools<span class="op">)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>install_github<span class="op">(</span><span class="st">"raivokolde/pheatmap"</span><span class="op">)</span></span></code></pre></div>
<p><a href="https://github.com/raivokolde/pheatmap" class="external-link uri">https://github.com/raivokolde/pheatmap</a></p>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<p>More important features of pheatmap include: * ability to directly control the size of the cells, text, etc * automatic generation of legends * row and column annotations * ability to post-edit the heatmap using <code>grid</code> graphics tools * easy way to separate clusters visually using spacers * reasonable defaults * …</p>
<p>Many of these features are on display in the next figure</p>
<div class="figure">
<img src="https://cloud.githubusercontent.com/assets/181403/12646618/30b70a76-c59f-11e5-8fdb-aab0fda50726.png" alt=""><p class="caption">pheatmap_example</p>
</div>
</div>
<div class="section level2">
<h2 id="exported-functions">Exported functions<a class="anchor" aria-label="anchor" href="#exported-functions"></a>
</h2>
<p><code>mat</code> numeric matrix of the values to be plotted.</p>
<p><code>color</code> vector of colors used in heatmap.</p>
<p><code>kmeans_k</code> the number of kmeans clusters to make, if we want to aggregate the rows before drawing heatmap. If NA then the rows are not aggregated.</p>
<p><code>breaks</code> a sequence of numbers that covers the range of values in mat and is one element longer than color vector. Used for mapping values to colors. Useful, if needed to map certain values to certain colors, to certain values. If value is NA then the breaks are calculated automatically. When breaks do not cover the range of values, then any value larger than max(breaks) will have the largest color and any value lower than min(breaks) will get the lowest color.</p>
<p><code>border_color</code> color of cell borders on heatmap, use NA if no border should be drawn.</p>
<p><code>cellwidth</code> individual cell width in points. If left as NA, then the values depend on the size of plotting window.</p>
<p><code>cellheight</code> individual cell height in points. If left as NA, then the values depend on the size of plotting window.</p>
<p><code>scale</code> character indicating if the values should be centered and scaled in either the row direction or the column direction, or none. Corresponding values are “row”, “column” and “none”</p>
<p><code>cluster_rows</code> boolean values determining if rows should be clustered or hclust object,</p>
<p><code>cluster_cols</code> boolean values determining if columns should be clustered or hclust object.</p>
<p><code>clustering_distance_rows</code> distance measure used in clustering rows. Possible values are “correlation” for Pearson correlation and all the distances supported by dist, such as “euclidean”, etc. If the value is none of the above it is assumed that a distance matrix is provided.</p>
<p><code>clustering_distance_cols</code> distance measure used in clustering columns. Possible values the same as for clustering_distance_rows.</p>
<p><code>clustering_method</code> clustering method used. Accepts the same values as hclust.</p>
<p><code>clustering_callback</code> callback function to modify the clustering. Is called with two parameters: original hclust object and the matrix used for clustering. Must return a hclust object.</p>
<p><code>cutree_rows</code> number of clusters the rows are divided into, based on the hierarchical clustering (using cutree), if rows are not clustered, the argument is ignored</p>
<p><code>cutree_cols</code> similar to cutree_rows, but for columns</p>
<p><code>treeheight_row</code> the height of a tree for rows, if these are clustered. Default value 50 points.</p>
<p><code>treeheight_col</code> the height of a tree for columns, if these are clustered. Default value 50 points.</p>
<p><code>legend</code> logical to determine if legend should be drawn or not.</p>
<p><code>legend_breaks</code> vector of breakpoints for the legend.</p>
<p><code>legend_labels</code> vector of labels for the legend_breaks.</p>
<p><code>annotation_row</code> data frame that specifies the annotations shown on left side of the heatmap. Each row defines the features for a specific row. The rows in the data and in the annotation are matched using corresponding row names. Note that color schemes takes into account if variable is continuous or discrete.</p>
<p><code>annotation_col</code> similar to annotation_row, but for columns.</p>
<p><code>annotation</code> deprecated parameter that currently sets the annotation_col if it is missing</p>
<p><code>annotation_colors</code> list for specifying annotation_row and annotation_col track colors manually. It is possible to define the colors for only some of the features. Check examples for details.</p>
<p><code>annotation_legend</code> boolean value showing if the legend for annotation tracks should be drawn.</p>
<p><code>annotation_names_row</code> boolean value showing if the names for row annotation tracks should be drawn.</p>
<p><code>annotation_names_col</code> boolean value showing if the names for column annotation tracks should be drawn.</p>
<p><code>drop_levels</code> logical to determine if unused levels are also shown in the legend</p>
<p><code>show_rownames</code> boolean specifying if column names are be shown.</p>
<p><code>show_colnames</code> boolean specifying if column names are be shown.</p>
<p><code>main</code> the title of the plot</p>
<p><code>fontsize</code> base fontsize for the plot</p>
<p><code>fontsize_row</code> fontsize for rownames (Default: fontsize)</p>
<p><code>fontsize_col</code> fontsize for colnames (Default: fontsize)</p>
<p><code>angle_col</code> angle of the column labels, right now one can choose only from few predefined options (0, 45, 90, 270 and 315)</p>
<p><code>display_numbers</code> logical determining if the numeric values are also printed to the cells. If this is a matrix (with same dimensions as original matrix), the contents of the matrix are shown instead of original values.</p>
<p><code>number_format</code> format strings (C printf style) of the numbers shown in cells. For example “%.2f” shows 2 decimal places and “%.1e” shows exponential notation (see more in sprintf).</p>
<p><code>number_color</code> color of the text</p>
<p><code>fontsize_number</code> fontsize of the numbers displayed in cells</p>
<p><code>gaps_row</code> vector of row indices that show where to put gaps into heatmap. Used only if the rows are not clustered. See cutree_row to see how to introduce gaps to clustered rows.</p>
<p><code>gaps_col</code> similar to gaps_row, but for columns.</p>
<p><code>labels_row</code> custom labels for rows that are used instead of rownames.</p>
<p><code>labels_col</code> similar to labels_row, but for columns.</p>
<p><code>filename</code> file path where to save the picture. Filetype is decided by the extension in the path. Currently following formats are supported: png, pdf, tiff, bmp, jpeg. Even if the plot does not fit into the plotting window, the file size is calculated so that the plot would fit there, unless specified otherwise.</p>
<p><code>width</code> manual option for determining the output file width in inches.</p>
<p><code>height</code> manual option for determining the output file height in inches.</p>
<p><code>silent</code> do not draw the plot (useful when using the gtable output)</p>
<p><code>na_col</code> specify the color of the NA cell in the matrix.</p>
<p><code>…</code> graphical parameters for the text used in plot. Parameters passed to grid.text, see gpar.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode s"><code class="sourceCode gnuassembler"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NOT RUN {</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create test matrix</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">test</span> <span class="op">=</span> matrix<span class="op">(</span>rnorm<span class="op">(</span><span class="dv">200</span><span class="op">),</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">10</span><span class="op">)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">test</span><span class="op">[</span><span class="fu">1:</span><span class="dv">10</span><span class="op">,</span> seq<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">)]</span> <span class="op">=</span> <span class="kw">test</span><span class="op">[</span><span class="fu">1:</span><span class="dv">10</span><span class="op">,</span> seq<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">)]</span> <span class="op">+</span> <span class="dv">3</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">test</span><span class="op">[</span><span class="fu">11:</span><span class="dv">20</span><span class="op">,</span> seq<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">)]</span> <span class="op">=</span> <span class="kw">test</span><span class="op">[</span><span class="fu">11:</span><span class="dv">20</span><span class="op">,</span> seq<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">)]</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">test</span><span class="op">[</span><span class="fu">15:</span><span class="dv">20</span><span class="op">,</span> seq<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">)]</span> <span class="op">=</span> <span class="kw">test</span><span class="op">[</span><span class="fu">15:</span><span class="dv">20</span><span class="op">,</span> seq<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">)]</span> <span class="op">+</span> <span class="dv">4</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>colnames<span class="op">(</span><span class="kw">test</span><span class="op">)</span> <span class="op">=</span> paste<span class="op">(</span><span class="st">"Test"</span><span class="op">,</span> <span class="fu">1:</span><span class="dv">10</span><span class="op">,</span> sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>rownames<span class="op">(</span><span class="kw">test</span><span class="op">)</span> <span class="op">=</span> paste<span class="op">(</span><span class="st">"Gene"</span><span class="op">,</span> <span class="fu">1:</span><span class="dv">20</span><span class="op">,</span> sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw heatmaps</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> kmeans_k <span class="op">=</span> <span class="dv">2</span><span class="op">)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> scale <span class="op">=</span> <span class="st">"row"</span><span class="op">,</span> clustering_distance_rows <span class="op">=</span> <span class="st">"correlation"</span><span class="op">)</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> color <span class="op">=</span> colorRampPalette<span class="op">(</span>c<span class="op">(</span><span class="st">"navy"</span><span class="op">,</span> <span class="st">"white"</span><span class="op">,</span> <span class="st">"firebrick3"</span><span class="op">))(</span><span class="dv">50</span><span class="op">))</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> cluster_row <span class="op">=</span> FALSE<span class="op">)</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> legend <span class="op">=</span> FALSE<span class="op">)</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Show text within cells</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> display_numbers <span class="op">=</span> TRUE<span class="op">)</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> display_numbers <span class="op">=</span> TRUE<span class="op">,</span> number_format <span class="op">=</span> <span class="st">"\%.1e"</span><span class="op">)</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> display_numbers <span class="op">=</span> matrix<span class="op">(</span>ifelse<span class="op">(</span><span class="kw">test</span> <span class="op">&gt;</span> <span class="dv">5</span><span class="op">,</span> <span class="st">"*"</span><span class="op">,</span> <span class="st">""</span><span class="op">),</span> nrow<span class="op">(</span><span class="kw">test</span><span class="op">)))</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> cluster_row <span class="op">=</span> FALSE<span class="op">,</span> legend_breaks <span class="op">=</span> <span class="fu">-1:</span><span class="dv">4</span><span class="op">,</span> legend_labels <span class="op">=</span> c<span class="op">(</span><span class="st">"0"</span><span class="op">,</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="st">"1e-4"</span><span class="op">,</span> <span class="st">"1e-3"</span><span class="op">,</span> <span class="st">"1e-2"</span><span class="op">,</span> <span class="st">"1e-1"</span><span class="op">,</span> <span class="st">"1"</span><span class="op">))</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix cell sizes and save to file with correct size</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> cellwidth <span class="op">=</span> <span class="dv">15</span><span class="op">,</span> cellheight <span class="op">=</span> <span class="dv">12</span><span class="op">,</span> main <span class="op">=</span> <span class="st">"Example heatmap"</span><span class="op">)</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> cellwidth <span class="op">=</span> <span class="dv">15</span><span class="op">,</span> cellheight <span class="op">=</span> <span class="dv">12</span><span class="op">,</span> fontsize <span class="op">=</span> <span class="dv">8</span><span class="op">,</span> filename <span class="op">=</span> <span class="st">"test.pdf"</span><span class="op">)</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate annotations for rows and columns</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>annotation_col <span class="op">=</span> data.frame<span class="op">(</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                    CellType <span class="op">=</span> factor<span class="op">(</span><span class="kw">rep</span><span class="op">(</span>c<span class="op">(</span><span class="st">"CT1"</span><span class="op">,</span> <span class="st">"CT2"</span><span class="op">),</span> <span class="dv">5</span><span class="op">)),</span> </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>                    Time <span class="op">=</span> <span class="fu">1:</span><span class="dv">5</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>                <span class="op">)</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>rownames<span class="op">(</span>annotation_col<span class="op">)</span> <span class="op">=</span> paste<span class="op">(</span><span class="st">"Test"</span><span class="op">,</span> <span class="fu">1:</span><span class="dv">10</span><span class="op">,</span> sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>annotation_row <span class="op">=</span> data.frame<span class="op">(</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                    GeneClass <span class="op">=</span> factor<span class="op">(</span><span class="kw">rep</span><span class="op">(</span>c<span class="op">(</span><span class="st">"Path1"</span><span class="op">,</span> <span class="st">"Path2"</span><span class="op">,</span> <span class="st">"Path3"</span><span class="op">),</span> c<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">)))</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                <span class="op">)</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>rownames<span class="op">(</span>annotation_row<span class="op">)</span> <span class="op">=</span> paste<span class="op">(</span><span class="st">"Gene"</span><span class="op">,</span> <span class="fu">1:</span><span class="dv">20</span><span class="op">,</span> sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Display row and color annotations</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> annotation_col <span class="op">=</span> annotation_col<span class="op">)</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> annotation_col <span class="op">=</span> annotation_col<span class="op">,</span> annotation_legend <span class="op">=</span> FALSE<span class="op">)</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> annotation_col <span class="op">=</span> annotation_col<span class="op">,</span> annotation_row <span class="op">=</span> annotation_row<span class="op">)</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Change angle of text in the columns</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> annotation_col <span class="op">=</span> annotation_col<span class="op">,</span> annotation_row <span class="op">=</span> annotation_row<span class="op">,</span> angle_col <span class="op">=</span> <span class="st">"45"</span><span class="op">)</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> annotation_col <span class="op">=</span> annotation_col<span class="op">,</span> angle_col <span class="op">=</span> <span class="st">"0"</span><span class="op">)</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify colors</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>ann_colors <span class="op">=</span> list<span class="op">(</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    Time <span class="op">=</span> c<span class="op">(</span><span class="st">"white"</span><span class="op">,</span> <span class="st">"firebrick"</span><span class="op">),</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    CellType <span class="op">=</span> c<span class="op">(</span>CT1 <span class="op">=</span> <span class="st">"#1B9E77"</span><span class="op">,</span> CT2 <span class="op">=</span> <span class="st">"#D95F02"</span><span class="op">),</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    GeneClass <span class="op">=</span> c<span class="op">(</span>Path1 <span class="op">=</span> <span class="st">"#7570B3"</span><span class="op">,</span> Path2 <span class="op">=</span> <span class="st">"#E7298A"</span><span class="op">,</span> Path3 <span class="op">=</span> <span class="st">"#66A61E"</span><span class="op">)</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> annotation_col <span class="op">=</span> annotation_col<span class="op">,</span> annotation_colors <span class="op">=</span> ann_colors<span class="op">,</span> main <span class="op">=</span> <span class="st">"Title"</span><span class="op">)</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> annotation_col <span class="op">=</span> annotation_col<span class="op">,</span> annotation_row <span class="op">=</span> annotation_row<span class="op">,</span> </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>         annotation_colors <span class="op">=</span> ann_colors<span class="op">)</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> annotation_col <span class="op">=</span> annotation_col<span class="op">,</span> annotation_colors <span class="op">=</span> ann_colors<span class="op">[</span><span class="dv">2</span><span class="op">])</span> </span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Gaps in heatmaps</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> annotation_col <span class="op">=</span> annotation_col<span class="op">,</span> cluster_rows <span class="op">=</span> FALSE<span class="op">,</span> gaps_row <span class="op">=</span> c<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">14</span><span class="op">))</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> annotation_col <span class="op">=</span> annotation_col<span class="op">,</span> cluster_rows <span class="op">=</span> FALSE<span class="op">,</span> gaps_row <span class="op">=</span> c<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">14</span><span class="op">),</span> </span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>         cutree_col <span class="op">=</span> <span class="dv">2</span><span class="op">)</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Show custom strings as row/col names</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>labels_row <span class="op">=</span> c<span class="op">(</span><span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> </span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="st">""</span><span class="op">,</span> <span class="st">""</span><span class="op">,</span> <span class="st">"Il10"</span><span class="op">,</span> <span class="st">"Il15"</span><span class="op">,</span> <span class="st">"Il1b"</span><span class="op">)</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> annotation_col <span class="op">=</span> annotation_col<span class="op">,</span> labels_row <span class="op">=</span> labels_row<span class="op">)</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifying clustering from distance matrix</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>drows <span class="op">=</span> dist<span class="op">(</span><span class="kw">test</span><span class="op">,</span> method <span class="op">=</span> <span class="st">"minkowski"</span><span class="op">)</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>dcols <span class="op">=</span> dist<span class="op">(</span>t<span class="op">(</span><span class="kw">test</span><span class="op">),</span> method <span class="op">=</span> <span class="st">"minkowski"</span><span class="op">)</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> clustering_distance_rows <span class="op">=</span> drows<span class="op">,</span> clustering_distance_cols <span class="op">=</span> dcols<span class="op">)</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify ordering of the clusters using clustering callback option</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>callback <span class="op">=</span> function<span class="op">(</span>hc<span class="op">,</span> mat<span class="op">){</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>    sv <span class="op">=</span> svd<span class="op">(</span>t<span class="op">(</span>mat<span class="op">))</span>$v<span class="op">[,</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>    dend <span class="op">=</span> reorder<span class="op">(</span>as.dendrogram<span class="op">(</span>hc<span class="op">),</span> wts <span class="op">=</span> sv<span class="op">)</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    as.hclust<span class="op">(</span>dend<span class="op">)</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> clustering_callback <span class="op">=</span> callback<span class="op">)</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="co"># NOT RUN {</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Same using dendsort package</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>library<span class="op">(</span>dendsort<span class="op">)</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>callback <span class="op">=</span> function<span class="op">(</span>hc<span class="op">,</span> ...<span class="op">){</span>dendsort<span class="op">(</span>hc<span class="op">)}</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>pheatmap<span class="op">(</span><span class="kw">test</span><span class="op">,</span> clustering_callback <span class="op">=</span> callback<span class="op">)</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a><span class="co"># NOT RUN {</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=pheatmap" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2" class="external-link">GPL-2</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing pheatmap</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Raivo Kolde <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Raivo Kolde.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
